```{r}
# install.packages("rpart")
library(rpart)
# install.packages("rpart.plot")
library(rpart.plot)
```


```{r}
dataset <- read.csv2('./datasets/survey_results_public.csv', header = TRUE, sep = ',')
columns = c("CompRange", "Country", "YearsCode", "YearsCodePro"
            , "OrgSize", "DevType", "EdLevel", "Age", "WorkExp", "RemoteWork"
          )
columns_for_future = c("LearnCode", "LanguageHaveWorkedWith", "PlatformHaveWorkedWith", "ToolstackHaveWorkedWith")
dt <- head(dataset[, columns], 100)
dt
```

# Transformando os dados em ranges
```{r}
# < 50_000
# >= 50.000 < 200.000
# >= 200.000 < 500.000
# >= 500.000 < 1.000.000
# >= 1.000.000
dataset_comp_range = dataset
dataset_comp_range$CompRange[
  dataset_comp_range$ConvertedCompYearly < 50000
] = "< $50.000"
dataset_comp_range$CompRange[
  dataset_comp_range$ConvertedCompYearly >= 50000 & dataset_comp_range$ConvertedCompYearly < 200000
] = ">= $50.000 and < $200.000"
dataset_comp_range$CompRange[
  dataset_comp_range$ConvertedCompYearly >= 200000 & dataset_comp_range$ConvertedCompYearly < 500000
] = ">= $200.000 and < $500.000"
dataset_comp_range$CompRange[
  dataset_comp_range$ConvertedCompYearly >= 500000 & dataset_comp_range$ConvertedCompYearly < 1000000
] = ">= $500.000 and < $1.000.000"
dataset_comp_range$CompRange[
  dataset_comp_range$ConvertedCompYearly >= 1000000
  ] = ">= $1.00.000"
dataset_comp_range$CompRange = as.factor(dataset_comp_range$CompRange)
dataset_comp_range
```

```{r}
# < 1
# >= 1 < 3
# >= 3 < 6
# >= 6 < 10
# >= 10 < 20
# >= 20
dataset_comp_range$YearsCode[
  dataset$YearsCode >= 1 & dataset$YearsCode < 3
] = ">= 1 and < 3"
dataset_comp_range$YearsCode[
  dataset$YearsCode >= 3 & dataset$YearsCode < 6
] = ">= 3 and < 6"
dataset_comp_range$YearsCode[
  dataset$YearsCode >= 6 & dataset$YearsCode < 10
] = ">= 6 and < 10"
dataset_comp_range$YearsCode[
  dataset$YearsCode >= 10 & dataset$YearsCode < 20
] = ">= 10 and < 20"
dataset_comp_range$YearsCode[
  dataset$YearsCode >= 20
] = ">= 20"
dataset_comp_range$YearsCode = as.factor(dataset_comp_range$YearsCode)


dataset_comp_range$YearsCodePro[
  dataset$YearsCodePro >= 1 & dataset$YearsCodePro < 3
] = ">= 1 and < 3"
dataset_comp_range$YearsCodePro[
  dataset$YearsCodePro >= 3 & dataset$YearsCodePro < 6
] = ">= 3 and < 6"
dataset_comp_range$YearsCodePro[
  dataset$YearsCodePro >= 6 & dataset$YearsCodePro < 10
] = ">= 6 and < 10"
dataset_comp_range$YearsCodePro[
  dataset$YearsCodePro >= 10 & dataset$YearsCodePro < 20
] = ">= 10 and < 20"
dataset_comp_range$YearsCodePro[
  dataset$YearsCodePro >= 20
] = ">= 20"
dataset_comp_range$YearsCodePro = as.factor(dataset_comp_range$YearsCodePro)

dataset_years_range = dataset_comp_range
```


```{r}
dt = head(dataset_years_range[, columns], 100)
dt
```


# Criando a Arvore de decisao
```{r}
modelo_salario <- rpart(CompRange~YearsCode+YearsCodePro+Country,
                                  data=dt,
                                  method="class",
                                  control=rpart.control(minsplit = 3, 
                                                        xval = 5),
                                  parms=list(split="Information"))
modelo_salario
```

```{r}
arvore_decisao <- rpart.plot(modelo_salario, type = 2)
arvore_decisao
```
